<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <title>–ü—ñ—Ä–∞–º—ñ–¥–∞ –î—É—à—ñ ‚Äî –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è</title>
  <style>
    body {
      background: linear-gradient(to bottom, #111, #222);
      color: #f3eac2;
      font-family: Georgia, serif;
      padding: 40px;
    }
    h1 {
      text-align: center;
      font-size: 32px;
      margin-bottom: 40px;
    }
    .pyramid {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 30px;
    }
    .row {
      display: flex;
      justify-content: center;
      gap: 20px;
    }
    .card {
      background: #1e1e1e;
      border: 1px solid #555;
      padding: 15px;
      border-radius: 10px;
      width: 260px;
      box-shadow: 0 0 10px #333;
    }
    .card h2 {
      font-size: 20px;
      margin-bottom: 10px;
      color: #ffdb70;
    }
    .card p {
      font-size: 14px;
      line-height: 1.5;
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <h1>üîÆ –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –ü—ñ—Ä–∞–º—ñ–¥–∏ –î—É—à—ñ</h1>

  <div class="pyramid" id="pyramidInterpretation">
    <!-- JS –¥–∏–Ω–∞–º—ñ—á–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç–∏–º–µ —Ç—É—Ç -->
  </div>

  <script type="module">
    import { deepInterpretations } from './interpretations_full.js';

    const cards = JSON.parse(sessionStorage.getItem("soulPyramid")) || [];

    const positions = [
      "1. –í–µ—Ä—à–∏–Ω–∞ (–ï–≥–æ)",
      "2. –õ—ñ–≤–µ –º–∏–Ω—É–ª–µ (–¢—ñ–Ω—å)",
      "3. –ü—Ä–∞–≤–µ –º–∞–π–±—É—Ç–Ω—î (–†–µ—Å—É—Ä—Å —á–∞—Å—É)",
      "4. –ù–∏–∂–Ω—ñ–π –ª—ñ–≤–∏–π (–ú–∏–Ω—É–ª–µ –ø—Å–∏—Ö–æ–¥–∏–Ω–∞–º—ñ–∫–∏)",
      "5. –ù–∏–∂–Ω—ñ–π —Ü–µ–Ω—Ç—Ä (–¢–µ–ø–µ—Ä—ñ—à–Ω—î –ø—Å–∏—Ö–æ–¥–∏–Ω–∞–º—ñ–∫–∏)",
      "6. –ù–∏–∂–Ω—ñ–π –ø—Ä–∞–≤–∏–π (–ú–∞–π–±—É—Ç–Ω—î –ø—Å–∏—Ö–æ–¥–∏–Ω–∞–º—ñ–∫–∏)"
    ];

    const pyramid = document.getElementById("pyramidInterpretation");

    const layout = [
      [0],       // 1-–π —è—Ä—É—Å ‚Äî –≤–µ—Ä—à–∏–Ω–∞
      [1, 2],    // 2-–π —è—Ä—É—Å ‚Äî —Ç—ñ–Ω—å —ñ —Ä–µ—Å—É—Ä—Å
      [3, 4, 5]  // 3-–π —è—Ä—É—Å ‚Äî –ø—Å–∏—Ö–æ–¥–∏–Ω–∞–º—ñ–∫–∞: –º–∏–Ω—É–ª–µ, —Ç–µ–ø–µ—Ä—ñ—à–Ω—î, –º–∞–π–±—É—Ç–Ω—î
    ];

    layout.forEach(rowIndexes => {
      const row = document.createElement("div");
      row.className = "row";

      rowIndexes.forEach(i => {
        const cardName = cards[i];
        const interp = deepInterpretations[cardName];

        const cardEl = document.createElement("div");
        cardEl.className = "card";

        cardEl.innerHTML = `
          <h2>${positions[i]} ‚Äî ${cardName || '–ù–µ–º–∞—î –∫–∞—Ä—Ç–∏'}</h2>
          <p><strong>–ê—Ä—Ö–µ—Ç–∏–ø:</strong> ${interp?.archetype || '–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'}</p>
          <p><strong>–¢—ñ–Ω—å:</strong> ${interp?.shadow || '–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'}</p>
          <p><strong>–ü–∞—Ä—Ç–Ω–µ—Ä—Å—Ç–≤–æ:</strong> ${interp?.partnerChoice || '–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'}</p>
          <p><strong>–ü—Ä–æ—Ñ–µ—Å—ñ—è:</strong> ${interp?.professionChoice || '–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'}</p>
          <p><strong>–†–µ–ø—Ä–µ—Å—ñ—è:</strong> ${interp?.repressionType || '–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'}</p>
          <p><strong>–ü—Å–∏—Ö–æ–¥–∏–Ω–∞–º—ñ–∫–∞:</strong> ${interp?.psychodynamic || '–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö'}</p>
        `;

        row.appendChild(cardEl);
      });

      pyramid.appendChild(row);
    });

    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É —Ç–∞ –≤–∏—Å–Ω–æ–≤–∫—É
    function generateSummary(cards, deepInterpretations) {
      if (!cards.length) return "–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É.";

      const apex = deepInterpretations[cards[0]] || {};
      const middleLeft = deepInterpretations[cards[1]] || {};
      const middleRight = deepInterpretations[cards[2]] || {};
      const lowerLeft = deepInterpretations[cards[3]] || {};
      const lowerCenter = deepInterpretations[cards[4]] || {};
      const lowerRight = deepInterpretations[cards[5]] || {};

      const apexRole = apex.archetype
        ? `–í–µ—Ä—à–∏–Ω–∞ –ø—ñ—Ä–∞–º—ñ–¥–∏ ‚Äî –∞—Ä—Ö–µ—Ç–∏–ø –ï–≥–æ: ${apex.archetype}. –¶–µ –≥–æ–ª–æ–≤–Ω–∞ —Ä–æ–ª—å —É –≤–∞—à—ñ–π –ø—Å–∏—Ö–æ–ª–æ–≥—ñ—ó.`
        : "–í–µ—Ä—à–∏–Ω–∞ –ø—ñ—Ä–∞–º—ñ–¥–∏ ‚Äî –∞—Ä—Ö–µ—Ç–∏–ø –ï–≥–æ –Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–æ.";

      const middleAspect = `–°–µ—Ä–µ–¥–Ω—ñ–π —è—Ä—É—Å –ø–æ–∫–∞–∑—É—î –±–∞–ª–∞–Ω—Å —Ç—ñ–Ω—ñ —Ç–∞ —Ä–µ—Å—É—Ä—Å—É —á–∞—Å—É:\n` +
        `- –¢—ñ–Ω—å: ${middleLeft.shadow || '–Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö'}\n` +
        `- –†–µ—Å—É—Ä—Å —á–∞—Å—É: ${middleRight.psychodynamic || '–Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö'}`;

      const lowerDynamics = `–ù–∏–∂–Ω—ñ–π —è—Ä—É—Å —Ä–æ–∑–∫—Ä–∏–≤–∞—î –ø—Å–∏—Ö–æ–¥–∏–Ω–∞–º—ñ–∫—É:\n` +
        `- –ú–∏–Ω—É–ª–µ: ${lowerLeft.psychodynamic || '–Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö'}\n` +
        `- –¢–µ–ø–µ—Ä—ñ—à–Ω—î: ${lowerCenter.psychodynamic || '–Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö'}\n` +
        `- –ú–∞–π–±—É—Ç–Ω—î: ${lowerRight.psychodynamic || '–Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö'}`;

      let conclusion = "–ó–∞–≥–∞–ª—å–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫: —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É –Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é —Ç—ñ–Ω—å–æ–≤–∏—Ö –∞—Å–ø–µ–∫—Ç—ñ–≤ —ñ —Ä–µ—Å—É—Ä—Å—ñ–≤ —á–∞—Å—É, –∞ —Ç–∞–∫–æ–∂ —É—Å–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Å–∏—Ö–æ–¥–∏–Ω–∞–º—ñ—á–Ω–∏—Ö –∑–º—ñ–Ω —É –º–∏–Ω—É–ª–æ–º—É, —Ç–µ–ø–µ—Ä—ñ—à–Ω—å–æ–º—É —Ç–∞ –º–∞–π–±—É—Ç–Ω—å–æ–º—É.";

      // –ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –≤–∏—Å–Ω–æ–≤–∫—É (–º–æ–∂–Ω–∞ –¥–æ–ø–æ–≤–Ω—é–≤–∞—Ç–∏ –∑–∞ –±–∞–∂–∞–Ω–Ω—è–º)
      if (apexRole.toLowerCase().includes("–∫–æ–Ω—Ñ–ª—ñ–∫—Ç")) {
        conclusion += " –í–µ—Ä—à–∏–Ω–∞ –ø—ñ—Ä–∞–º—ñ–¥–∏ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –∫–æ–Ω—Ñ–ª—ñ–∫—Ç, —è–∫–∏–π –ø–æ—Ç—Ä–µ–±—É—î —É–≤–∞–≥–∏.";
      }

      return `${apexRole}\n\n${middleAspect}\n\n${lowerDynamics}\n\n${conclusion}`;
    }

    const summaryDiv = document.createElement("div");
    summaryDiv.style = `
      margin-top: 50px;
      background: #1b1b1b;
      padding: 25px;
      border-radius: 15px;
      box-shadow: 0 0 10px #444;
      font-size: 16px;
      line-height: 1.5;
      white-space: pre-wrap;
    `;

    summaryDiv.innerHTML = `<h2 style="color: #ffdb70;">üîé –ó–∞–≥–∞–ª—å–Ω–∏–π –ê–Ω–∞–ª—ñ–∑ –ü—ñ—Ä–∞–º—ñ–¥–∏ –î—É—à—ñ</h2><p>${generateSummary(cards, deepInterpretations)}</p>`;

    pyramid.appendChild(summaryDiv);
  </script>
</body>
</html>
